# 十二 深度生成模型概述

## 1 Hopfield神经网络(1982)

- 神经网络可以分为
  - **多层神经网络**：模式识别
  - **相互连接型网络**：通过联想记忆去除数据中的噪声

- Hopfield神经网络是最典型的`相互连结型网络`。`联想记忆`就是当输入模式为某种状态时，输出端要给出与之相应的输出模式。如果输入模式与输出模式一致，称为自联想记忆，否则称为异联想记忆

## 2 玻尔兹曼机和受限玻尔兹曼机(1983)

### 2.1 玻尔兹曼机 
- **玻尔兹曼机**也是相互连接型网络，可以通过让每个单元按照一定的概率分布发生状态变化，来避免陷入局部最优解。玻尔兹曼机选择`模拟退火`算法，可以先采用较大的温度系 数及进行粗调，然后逐渐减小温度系数进行微调

- 玻尔兹曼机保持了Hopfield神经网络的假设
  - 权重对称
  - 自身无连接
  - 二值输出

- **模拟退火算法**

模拟退火是一种贪心算法，但是它的搜索过程引入了随机因素，以一定的概率来接受一个比当前解要差的解，因此有可能会跳出这个局部的最优解，达到全局的最优解，而且这个概率随着时间推移逐渐降低(逐渐降低才能趋向稳定)

- **训练过程**
  1. 训练准备：初始化连接权重 $𝑤_{𝑖𝑗}$ 和偏置 $𝑏_𝑖$
  2. 调整参数
     2.1 选取一个单元 $𝑖$, 求 $𝑢_𝑖$
     2.2 根据$𝑢_𝑖$ 的值，计算输出 $𝑥_𝑖$
     2.3 根据输出 $𝑥_𝑖$ 和 $𝑥_𝑗$ 的值，调整连接权重 $𝑤_{𝑖𝑗}$ 和偏置 $𝑏_𝑖$

     重复步骤2，直到满足终止判断条件

通常，使用对数似然函数求解

$$
\ln L(\theta)=\sum_{n=1}^{N} \ln p\left(x_{n} \mid \theta\right)
$$

### 2.2 受限玻尔兹曼机

- 含有隐藏变量的波尔兹曼机训练非常困难。所以Hinton等人提出了**受限玻尔兹曼机**
  - 由可见层和隐藏层构成
  - 层内单元之间无连接
  - 信息可双向流动

- **能量函数**：

$$
\begin{gathered}
E(\mathbf{v}, \mathbf{h}, \theta)=-\sum_{i=1}^{n_{v}} a_{i} v_{i}-\sum_{j=1}^{n_{h}} b_{j} h_{j}-\sum_{i=1}^{n_{v}} \sum_{j=1}^{n_{h}} w_{i j} v_{i} h_{j} \\
E(\mathbf{v}, \mathbf{h}, \theta)=-\mathbf{a}^{T} \mathbf{v}-\mathbf{b}^{T} \mathbf{h}-\mathbf{h}^{T} W \mathbf{v}
\end{gathered}
$$

其中，$a_i$ 是可见变量的偏置，$b_j$ 是隐藏变量的偏置，$w_{ij}$ 是连接权重，$\theta = (W,a,b)$ 表示参数集合。

## 3 深度玻尔兹曼机和深度信念网络

深度玻尔兹曼机(Deep Boltzmann Machine, DBM) 是由受限玻尔兹曼机堆叠组成。

深度信念网络(Deep Belief Network, DBN)：最上面的两层之间有无方向的对称连接，形成联想记忆。下层从上层接收自上而下的定向连接。最底层单元的状态表示一个数据向量。

- **训练方法**
  1. 首先训练输入层和隐藏层之间的参数，把训练后得到的参数作为下一层的输入
  2. 再调整该层与下一个隐藏层之间的参数
  3. 然后逐次迭代，完成多层网络的训练

- 深度玻尔兹曼机既可以当作**生成模型**，也可以当作**判别模型**

  - 作为生成模型使用时，网络会按照某种概率分布生成训练数据。通常选择最大似然估计法训练参数，得到最能覆盖训练样本的概率分布。对输入数据压缩和特征表达
  - 作为判别模型使用时，需要在模型顶层添加一层Softmax实现分类。进行分类时，需要同时提供训练样本和期望输出，在最顶层级联一个𝑆𝑜𝑓𝑡𝑚𝑎𝑥层

## 4 自编码器

**自编码器**(Autoencoder):是一种有效的数据维度压缩算法。是一种基于无监督学习的神经网络，目的在于通过不断调整参数， 重构经过维度压缩的输入样本。主要应用在
- 构建一种能够重构输入样本并进行特征表达的神经网络
  - 特征表达：是指对于分类会发生变动的不稳定模式或者输入样本中包含噪声等情况
- 训练多层神经网络时，通过自编码器训练样本得到参数初始值

当样本中包含噪声时，如果神经网络能够消除噪声，则被称为**降噪自编码器**(Denoising Autoencoder)，还有一种称为**稀疏自编码器**(Sparse Autoencoder)的网络，它在自编码器中引入了正则化项，以去除冗余信息。
